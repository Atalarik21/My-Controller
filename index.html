<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ATTAMATION</title>
  <style>
    body {
      background-color: #f9f9f9;
      font-family: Arial, sans-serif;
      color: #1a1a3d;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    .status-container {
      position: absolute;
      top: 20px;
      left: 20px;
      display: flex;
      align-items: center;
      font-size: 18px;
    }
    .status-dot {
      height: 15px;
      width: 15px;
      border-radius: 50%;
      margin-right: 8px;
      border: 1.5px solid #1a1a3d;
    }
    .status-dot.online {
      background-color: green;
    }
    .status-dot.offline {
      background-color: transparent;
    }
    h1 {
      margin-top: 60px;
      font-size: 32px;
      letter-spacing: 2px;
    }
    .relay-section {
      margin-top: 40px;
    }
    .relay-title {
      font-size: 22px;
      margin-bottom: 15px;
    }
    .button {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      border: 2px solid #1a1a3d;
      background-color: transparent;
      font-size: 18px;
      font-weight: bold;
      color: #1a1a3d;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .button.on {
      background-color: #2ecc71;
      color: white;
      border: none;
    }
    .status-label {
      margin-top: 10px;
      font-size: 16px;
    }
  </style>
</head>
<body>
  <div class="status-container">
    <div id="statusDot" class="status-dot offline"></div>
    <span id="statusText">Offline</span>
  </div>

  <h1>ATTAMATION</h1>

  <div class="relay-section">
    <div class="relay-title">Relay 1</div>
    <button id="relay1Button" class="button" onclick="toggleRelay(1)">OFF</button>
    <div class="status-label">Status = <span id="relay1Status">OFF</span></div>
  </div>

  <div class="relay-section">
    <div class="relay-title">Relay 2</div>
    <button id="relay2Button" class="button" onclick="toggleRelay(2)">OFF</button>
    <div class="status-label">Status = <span id="relay2Status">OFF</span></div>
  </div>

  <script>
    // Contoh MQTT dan status updater (harus disesuaikan sesuai implementasimu)
    let connected = false;

    function updateConnectionStatus(isConnected) {
      const dot = document.getElementById("statusDot");
      const text = document.getElementById("statusText");
      if (isConnected) {
        dot.classList.add("online");
        dot.classList.remove("offline");
        text.textContent = "Online";
      } else {
        dot.classList.remove("online");
        dot.classList.add("offline");
        text.textContent = "Offline";
      }
    }

    function toggleRelay(relayNum) {
      const btn = document.getElementById(`relay${relayNum}Button`);
      const status = document.getElementById(`relay${relayNum}Status`);
      const currentState = btn.textContent;
      const newState = currentState === "ON" ? "OFF" : "ON";

      // Ubah tampilan tombol langsung
      btn.textContent = newState;
      btn.classList.toggle("on", newState === "ON");

      // Status relay menunggu feedback dari ESP
      // Kirim ke MQTT topic
      if (connected) {
        const topic = `esp/relay${relayNum}`;
        client.publish(topic, newState);
      }
    }

    // Fungsi update status relay dari feedback MQTT
    function updateRelayStatus(relayNum, state) {
      const btn = document.getElementById(`relay${relayNum}Button`);
      const status = document.getElementById(`relay${relayNum}Status`);
      status.textContent = state;
      btn.classList.toggle("on", state === "ON");
    }

    // Simulasi awal
    updateConnectionStatus(false);
  </script>
</body>
</html>
