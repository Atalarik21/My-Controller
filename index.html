<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Device Configuration</title>

<style>
body {
  background: #0b0f1a;
  color: #e6eef8;
  font-family: Arial, sans-serif;
  padding: 20px;
}

.card {
  background: #111726;
  padding: 20px;
  border-radius: 12px;
  max-width: 600px;
  margin: auto;
  border: 1px solid rgba(255,255,255,0.1);
  box-shadow: 0 0 20px rgba(0,0,50,0.3);
}

h2 {
  margin-top: 0;
  color: #00f1ff;
  font-size: 22px;
  text-align: center;
}

label {
  display: block;
  margin-top: 12px;
  font-size: 14px;
  color: #9aa3b2;
}

input {
  width: 100%;
  padding: 10px;
  margin-top: 6px;
  border-radius: 8px;
  border: none;
  background: #0d1222;
  color: #00f1ff;
}

button {
  width: 100%;
  padding: 12px;
  margin-top: 20px;
  border: none;
  border-radius: 8px;
  background: linear-gradient(90deg,#00f1ff,#9b4dff);
  color: #021;
  font-weight: bold;
  cursor: pointer;
  font-size: 16px;
}

button:active {
  transform: scale(0.97);
}

.msg {
  margin-top: 15px;
  padding: 10px;
  text-align: center;
  border-radius: 6px;
  display: none;
}
.msg.ok { background: #003d24; color: #00ff9d; }
.msg.err { background: #3d0000; color: #ff8080; }
</style>

</head>
<body>

<div class="card">
  <h2>WiFi & MQTT Configuration</h2>

  <label>WiFi SSID</label>
  <input id="ssid" placeholder="Enter SSID" />

  <label>WiFi Password</label>
  <input id="pass" placeholder="Enter Password" type="password" />

  <label>MQTT Server</label>
  <input id="mqtt_server" placeholder="ex: broker.hivemq.com" />

  <label>MQTT Port</label>
  <input id="mqtt_port" type="number" placeholder="8883" />

  <label>MQTT Username</label>
  <input id="mqtt_user" placeholder="MQTT Username" />

  <label>MQTT Password</label>
  <input id="mqtt_pass" type="password" placeholder="MQTT Password" />

  <button onclick="saveConfig()">SAVE CONFIG</button>

  <div class="msg" id="msg"></div>
</div>

<script>
function saveConfig() {
  const data = {
    ssid: document.getElementById("ssid").value,
    pass: document.getElementById("pass").value,
    mqtt_server: document.getElementById("mqtt_server").value,
    mqtt_port: Number(document.getElementById("mqtt_port").value),
    mqtt_user: document.getElementById("mqtt_user").value,
    mqtt_pass: document.getElementById("mqtt_pass").value
  };

  fetch("/api/save", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(r => {
    if (r.status == 200) {
      showMsg("Configuration saved. Restarting...", "ok");
    } else {
      showMsg("Failed to save config", "err");
    }
  })
  .catch(() => {
    showMsg("Cannot connect to ESP (If you open via GitHub, this is normal)", "err");
  });
}

function showMsg(text, type) {
  const box = document.getElementById("msg");
  box.innerHTML = text;
  box.className = "msg " + type;
  box.style.display = "block";
}
</script>

</body>
</html>
